<script>
  const originalNames = ['صالح', 'ناصر', 'حمید', 'مجید', 'محمد', 'امین', 'فرزاد', 'حسین'];

  const matchMap = {
    'm1a': 'q1',
    'm1b': 'q1',
    'm2a': 'q2',
    'm2b': 'q2',
    'm3a': 'q3',
    'm3b': 'q3',
    'm4a': 'q4',
    'm4b': 'q4',
    'q1': 's1',
    'q2': 's1',
    'q3': 's2',
    'q4': 's2',
    's1': 'final',
    's2': 'final'
  };

  function shuffle(array) {
    let result = [...array];
    for (let i = result.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [result[i], result[j]] = [result[j], result[i]];
    }
    return result;
  }

  function fillInitialMatches() {
    const shuffledNames = shuffle(originalNames);
    const ids = ['m1a', 'm1b', 'm2a', 'm2b', 'm3a', 'm3b', 'm4a', 'm4b'];
    ids.forEach((id, index) => {
      const el = document.getElementById(id);
      el.textContent = shuffledNames[index];
      el.classList.remove('winner');
    });
  }

  function reset() {
    // پاک کردن مراحل بعدی
    document.querySelectorAll(".match").forEach(el => {
      if (!el.id.startsWith('m')) {
        el.textContent = "";
        el.classList.remove("winner");
      }
    });

    // پر کردن رندوم مرحله اول
    fillInitialMatches();
  }

  function handleClick(e) {
    const current = e.target;
    const nextId = matchMap[current.id];
    if (!nextId) return;

    const next = document.getElementById(nextId);
    if (next && !next.textContent) {
      next.textContent = current.textContent;
      next.classList.add("winner");
    }
  }

  document.querySelectorAll(".match").forEach(el => {
    el.addEventListener("click", handleClick);
  });

  window.addEventListener('load', fillInitialMatches);
</script>
